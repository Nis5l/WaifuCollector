<div class="nav">

    <a href="/" class="logo">

        <h1>WaifuCollector</h1>

    </a>

    <ul class="nav-list">

        <%if (userID) { %>

            <%if (locals.rankID && rankID == 1) { %>

            <li><a href="<%= url %>/adminpanel">Adminpanel</a></li>

            <% } %>

        <form class="redirectForm" action="/redirect" method="get">
            <input type="hidden" name="notificationID" value=""/>
            <input type="hidden" name="url" value=""/>
        </form>

		<%if (notifications) {%>
        <li><a class="bell"><i class="fas fa-bell"> <%= notifications.length%></i></a></li>
		<% } %>
        <li><a href="<%= url %>/dashboard">Dashboard</a></li>
        <li><a href="<%= url %>/logout"><i class="fas fa-sign-out-alt"></i></a></li>

        <script
        src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous"></script>
	
		<script>
			var redirectForm = document.querySelector(".redirectForm");
			var nb = undefined;
            const data = <%- JSON.stringify(notifications) %>;
			$(".bell").click(() => {
				document.body.insertAdjacentHTML('afterend',
					`<notification-box> </notification-box>`);
				nb = document.querySelector("notification-box")
				nb.closeCallback = () => {
					nb.remove();
					nb = undefined;
				}
				nb.elementCallback = (nID ,eurl) => {
					var url = '<%= url %>/' + eurl;
					redirectForm.notificationID.value = nID;
					redirectForm.url.value = eurl;
					redirectForm.submit();
				}
				for(var i = 0; i < data.length; i++)
				{
					var box = nb.shadowRoot.querySelector(".box");
					box.insertAdjacentHTML('beforeend', `<notification-element title="${data[i].title}" message="${data[i].message}" url="${data[i].url}" nId="${data[i].id}"> </notification-element>`);
				}
			});	

		</script>
		
        <% }else{ %>

            <li><a href="<%= url %>/login">Login</a></li>
            <li><a href="<%= url %>/register">Register</a></li>

        <% } %>

    </ul>

</div>
