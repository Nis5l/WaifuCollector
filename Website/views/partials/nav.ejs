<div class="nav">

	<%if (typeof ishome == 'undefined') { %>
		<a class="burger"><i class="fas fa-bars"></i></a>
    <% } %>

	<a href="/" class="logo">

		<h1 style="margin-left: <%= (typeof ishome != 'undefined') ? "20px":"0px"; %>" >WaifuCollector</h1>

    </a>

    <ul class="nav-list">

        <%if (userID) { %>

            <%if (locals.rankID && rankID == 1) { %>

            <li><a href="<%= url %>/adminpanel">Adminpanel</a></li>

            <% } %>

			<%if (typeof ishome != 'undefined') { %>
				<li><a href="<%= url %>/dashboard">Dashboard</a></li>
            <% } %>
		
		<%if (notifications) {%>

			<li style="cursor: pointer;"><a class="bell"><i class="fas fa-bell"> <%= notifications.length%></i></a></li>
			
		<% } %>

        <li><a href="<%= url %>/logout"><i class="fas fa-sign-out-alt"></i></a></li>

        <script
        src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous"></script>
	
		<script>
			var redirectForm = document.querySelector(".redirectForm");
			var nb = undefined;
            var data = <%- JSON.stringify(notifications) %>;
			$(".bell").click(() => {
				document.body.insertAdjacentHTML('afterend',
					`<notification-box> </notification-box>`);
				nb = document.querySelector("notification-box")
				nb.closeCallback = () => {
					nb.remove();
					nb = undefined;
				}
				nb.elementCallback = (nID ,eurl) => {
				  var xhttp = new XMLHttpRequest();
				  xhttp.open("POST", `/deleteNotification`, true);
				  xhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
				  xhttp.onreadystatechange = function() { 
						if (xhttp.readyState == 4 && xhttp.status == 200)
							window.location.href = eurl;
				  }
				  xhttp.send(JSON.stringify({notificationID: nID}));
				}

				nb.deleteAllCallback = () => {
				  var xhttp = new XMLHttpRequest();
				  xhttp.open("POST", `/deleteAllNotifications`, true);
				  xhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
				  xhttp.onreadystatechange = function() { 
						if (xhttp.readyState == 4 && xhttp.status == 200)
						{
							document.querySelector(".fa-bell").innerText = " 0";
							nb.clearAll();
							data = [];
						}
				  }
				  xhttp.send();
				}

				for(var i = 0; i < data.length; i++)
				{
					var box = nb.shadowRoot.querySelector(".box");
					box.insertAdjacentHTML('beforeend', `<notification-element title="${data[i].title}" message="${data[i].message}" url="${data[i].url}" nId="${data[i].id}"> </notification-element>`);
				}
			});	

			var sidebarOut = true;
		//	$(".dashboard_content").css("--sideBar", "0px");
			$(".burger").click(()=>{
				if(sidebarOut)
				{
					$(".sidebar").css("transform", "translateX(-250px)");
					$(".dashboard_content").css("--sideBar", "0px");
				}else
				{
					$(".sidebar").css("transform", "translateX(0px)");
					$(".dashboard_content").css("--sideBar", "250px");
				}
				sidebarOut = !sidebarOut;
			});

		</script>
		
        <% }else{ %>

            <li><a href="<%= url %>/login">Login</a></li>
            <li><a href="<%= url %>/register">Register</a></li>

        <% } %>

    </ul>

</div>
