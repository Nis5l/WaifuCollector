<!DOCTYPE html>
<html lang="en">

    <head>

        <%- include('partials/standard_header.ejs') %>

        <title>WaifuCollector | Dashboard</title>
        
        <link rel="stylesheet" href="<%= url %>/resources/css/dashboard.css">
        <link rel="stylesheet" href="<%= url %>/resources/css/dashboard_sidebar.css">

        <style>

            .nav{

                position: fixed;
                top: 0;
                left: 0;

                box-shadow: 0px 1px 8px rgba(0, 0, 0, 0.5);

            }

        </style>

    </head>

    <body class="scrollable">

        <%- include('partials/nav.ejs') %>

        <div class="sidebar">

            <%- include('partials/dash_nav.ejs') %>

        </div>

        <div class="dashboard_content">
			<div class="dashboard_content_wrapper">
				<div class="dashboard_stats">
					<h2 id="dashboard_username"><%= dashboard.name %></h2>
					<p id="dashboard_friends"><%="Friends " + dashboard.friendcount + "/" + dashboard.maxfriendcount%></p>
					<p id="dashboard_cards"><%="Waifus " + dashboard.cardCount + "/" + dashboard.cardMax%></p>
                    <a id="settings" href="/settings"><i class="fas fa-cog fa-2x"></i></a>
				</div>
				<div class="progress_wrapper">
						<progress-ring name="progress" stroke="4" radius="130" progress=<%= 100 - dashboard.packTime /  dashboard.fullTime %>) time=<%=dashboard.packTime <= 0 ? 0 : dashboard.packTime %>></progress-ring>
				</div>
			</div>
        </div>

		<script>
			const progress_el = document.querySelector('progress-ring');
			function updateTimeDash()
			{
                var perc = 100 - (time / fulltime * 100);
				progress_el.setAttribute('progress', perc);
				progress_el.setAttribute('time', time);
			}
		</script>

		<script>
			$(".progress_wrapper").mouseenter(() => {
				progress_el.setFocused(true);
			}).mouseleave(() => {
				progress_el.setFocused(false);
			}).click(() => {
				if(onPack != undefined) onPack();
			});
		</script>

        <script
        src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous"></script>

        <script src="../resources/components.js"></script>
        
        <%- include('partials/error.ejs') %>
    </body>

</html>
