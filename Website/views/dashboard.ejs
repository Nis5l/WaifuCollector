<!DOCTYPE html>
<html lang="en">

    <head>

        <%- include('partials/standard_header.ejs') %>

        <title>WaifuCollector | Dashboard</title>
        
        <link rel="stylesheet" href="<%= url %>/resources/css/dashboard.css">
        <link rel="stylesheet" href="<%= url %>/resources/css/dashboard_sidebar.css">

        <style>

            .nav{

                position: fixed;
                top: 0;
                left: 0;

                box-shadow: 0px 1px 8px rgba(0, 0, 0, 0.5);

            }

        </style>

    </head>

    <body class="scrollable">

        <%- include('partials/nav.ejs') %>

        <div class="sidebar">

            <%- include('partials/dash_nav.ejs') %>

        </div>

        <div class="dashboard_content">
			<div class="dashboard_content_wrapper">
				<div class="dashboard_stats">
					<h2 id="dashboard_username"><%= dashboard.name %></h2>
					<p id="dashboard_friends"><%="Friends " + dashboard.friendcount + "/" + dashboard.maxfriendcount%></p>
					<p id="dashboard_cards"><%="Waifus " + dashboard.cardCount + "/" + dashboard.cardMax%></p>
					<p id="dashboard_cards"><%="Trades " + dashboard.tradesAvailavble + "/" + dashboard.tradesAvailavbleMax%></p>
                    <a id="settings" href="/settings"><i class="fas fa-cog fa-2x"></i></a>
				</div>
				<div class="progress_wrapper">
                    <progress-ring
                        id="openpack"
                        name="progress"
                        stroke="4"
                        radius="130"
                        progress=<%= 100 - dashboard.packTime / dashboard.fullTime %>
                        time=<%=dashboard.packTime <= 0 ? 0 : dashboard.packTime %>
                    >
                    </progress-ring>
                    <div class="progress_wrapper_anime">
                        <progress-ring
                            id="openanimepack"
                            name="progress"
                            stroke="4"
                            radius="90"
                            progress=100
                            time=99
                        >
                        </progress-ring>
                    </div>
                </div>
			</div>
        </div>

		<script>
			const progressel = document.querySelector('#openpack');
			function updateTimeDash()
			{
                var perc = 100 - (time / fullTime * 100);
				progressel.setAttribute('progress', perc);
				progressel.setAttribute('time', time);
			}

			const progressanimeel = document.querySelector('#openanimepack');
            function updateAnimeTimeDash()
            {
                var perc = 100 - (animeTime / fullTimeAnime * 100);
                progressanimeel.setAttribute('progress', perc);
                progressanimeel.setAttribute('time', animeTime);
            }
		</script>

        <script src="../resources/components.js"></script>
		<script>
            progressel.onopen = () => {
                if(onPack != undefined) onPack();
            };
            progressanimeel.onopen = () => {
                if(onAnimePack != undefined) onAnimePack();
            };
		</script>

        <script
        src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous"></script>

        
        <%- include('partials/error.ejs') %>
    </body>

</html>
